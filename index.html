<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Monte Carlo</title>
<meta name="color-scheme" content="light dark" />

<style>
:root{
  --bg:#ffffff; --text:#0a0a0a; --line:#e5e7eb;
  --ok:#34c759; --bad:#ff3b30; --chip:#f5f7fa;
}
@media (prefers-color-scheme: dark){
  :root{--bg:#0b0c0f;--text:#ededf0;--line:#20242c;--ok:#34c759;--bad:#ff453a;--chip:#13161b;}
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);color:var(--text);
  font:16px/1.6 -apple-system, BlinkMacSystemFont, "SF Pro Text","SF Pro Display",Segoe UI,Roboto,"Noto Sans JP",sans-serif;
  -webkit-font-smoothing:antialiased;
  display:flex;flex-direction:column;min-height:100vh;
}
header{padding:18px 22px;font-weight:700;font-size:18px;border-bottom:1px solid var(--line)}
main{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px 120px;text-align:center}

/* Sequence */
.seq-shell{
  display:inline-flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;
  border:1px solid var(--line);border-radius:20px;padding:16px 20px;background:var(--chip);
}
.seq-chip{
  border:1px solid var(--line);
  border-radius:12px;
  padding:10px 14px;
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  font-weight:700;
  font-size:clamp(28px,8vw,50px);
  line-height:1.1;
  min-width:2ch;text-align:center;
}

/* Next bet */
.next-value{
  margin-top:28px;
  font-weight:900;
  font-variant-numeric:tabular-nums;
  font-size:clamp(40px,10vw,64px);
}
.unit{font-size:14px;opacity:.6;margin-top:2px}

/* Footer buttons */
.footer{
  position:fixed;inset:auto 0 0 0;
  background:color-mix(in oklab,var(--bg) 92%, transparent);
  border-top:1px solid var(--line);
  padding:12px 20px;
  display:flex;gap:14px;justify-content:center;
}
.btn{
  flex:1;max-width:300px;
  appearance:none;cursor:pointer;
  border-radius:14px;padding:18px 0;
  font-weight:800;font-size:18px;letter-spacing:.5px;
  border:none;transition:transform .05s ease,opacity .2s ease;
}
.btn:active{transform:translateY(1px)}
.btn:disabled{opacity:.4;cursor:not-allowed}
.btn-win{background:var(--ok);color:#08140c}
.btn-lose{background:var(--bad);color:#fff}

/* Animations */
.flash{animation:flash .45s}
@keyframes flash{from{box-shadow:0 0 0 0 rgba(10,132,255,.35)}to{box-shadow:0 0 0 22px rgba(10,132,255,0)}}
</style>
</head>
<body>
<header>Monte Carlo</header>

<main>
  <div id="seqShell" class="seq-shell"></div>
  <div id="bet" class="next-value">1</div>
  <div class="unit">Next Bet (units)</div>
</main>

<div class="footer">
  <button id="win" class="btn btn-win">WIN</button>
  <button id="lose" class="btn btn-lose">LOSE</button>
</div>

<script>
const $=id=>document.getElementById(id);
const shell=$('seqShell'), bet=$('bet'), win=$('win'), lose=$('lose');

let seq=[0,1];
function yen(n){return Number(n||0).toLocaleString('ja-JP');}

function nextUnits(){
  if(!seq.length) return 0;
  if(seq.length===1){
    if(seq[0]===1) return 0;
    const a=Math.floor(seq[0]/2), b=Math.ceil(seq[0]/2);
    return a+b;
  }
  return seq[0]+seq[seq.length-1];
}

function renderSeq(){
  shell.innerHTML='';
  seq.forEach(n=>{
    const s=document.createElement('span');
    s.className='seq-chip';
    s.textContent=n;
    shell.appendChild(s);
  });
}

function updateUI(flash=false){
  renderSeq();
  const u=nextUnits();
  bet.textContent=u;
  if(flash){bet.classList.add('flash');setTimeout(()=>bet.classList.remove('flash'),450);}
  win.disabled=lose.disabled=(u===0);
}

function endCycle(){seq=[0,1];}

function onWin(){
  const u=nextUnits(); if(!u) return;
  if(seq.length>=2){seq.shift();seq.pop();}
  if(seq.length===0){endCycle();}
  else if(seq.length===1){
    if(seq[0]===1){endCycle();}
    else{const n=seq[0];seq=[Math.floor(n/2),Math.ceil(n/2)];}
  }
  updateUI(true);
}

function onLose(){
  const u=nextUnits(); if(!u) return;
  seq.push(u);
  updateUI(true);
}

win.addEventListener('click',onWin);
lose.addEventListener('click',onLose);
updateUI();
</script>
</body>
</html>
